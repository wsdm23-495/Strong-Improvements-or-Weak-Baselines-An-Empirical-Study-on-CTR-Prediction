/data/slc/anaconda3/envs/tf1/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:526: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/data/slc/anaconda3/envs/tf1/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:527: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/data/slc/anaconda3/envs/tf1/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:528: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/data/slc/anaconda3/envs/tf1/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:529: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/data/slc/anaconda3/envs/tf1/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:530: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/data/slc/anaconda3/envs/tf1/lib/python3.7/site-packages/tensorflow/python/framework/dtypes.py:535: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
task_type  train
model_dir  ./checkpoint/movielens/20220213
data_dir  ../data/movielens/
dt_dir  20220213
feature_size  92000
field_size  3
embedding_size  10
batch_size  4096
deep_layers  400,400,400
dropout  1.,1.,1.
optimizer  Adam
learning_rate  0.001
batch_norm_decay  0.9
batch_norm  True
ensemble  True
tr_files: ['../data/movielens/train.libsvm']
va_files: ['../data/movielens/valid.libsvm']
te_files: ['../data/movielens/test.libsvm']
[Errno 2] No such file or directory: './checkpoint/movielens/20220213' at clear_existing_model
INFO:tensorflow:Using config: {'_model_dir': './checkpoint/movielens/20220213', '_tf_random_seed': None, '_save_summary_steps': 100, '_save_checkpoints_steps': 343, '_save_checkpoints_secs': None, '_session_config': gpu_options {
  allow_growth: true
}
, '_keep_checkpoint_max': 5, '_keep_checkpoint_every_n_hours': 10000, '_log_step_count_steps': 100, '_train_distribute': None, '_device_fn': None, '_protocol': None, '_eval_distribute': None, '_experimental_distribute': None, '_service': None, '_cluster_spec': <tensorflow.python.training.server_lib.ClusterSpec object at 0x7fff21735ed0>, '_task_type': 'worker', '_task_id': 0, '_global_id_in_cluster': 0, '_master': '', '_evaluation_master': '', '_is_chief': True, '_num_ps_replicas': 0, '_num_worker_replicas': 1}

WARNING: The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
If you depend on functionality not listed there, please file an issue.

INFO:tensorflow:Not using Distribute Coordinator.
INFO:tensorflow:Running training and evaluation locally (non-distributed).
INFO:tensorflow:Start train and evaluate loop. The evaluate will happen after every checkpoint. Checkpoint frequency is determined based on RunConfig arguments: save_checkpoints_steps 343 or save_checkpoints_secs None.
WARNING:tensorflow:From /data/slc/anaconda3/envs/tf1/lib/python3.7/site-packages/tensorflow/python/framework/op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
Parsing ['../data/movielens/train.libsvm']
INFO:tensorflow:Calling model_fn.
shape of embeddings: [None, 3, 10]
[None, 10, 800]
WARNING:tensorflow:From ./AFN.py:124: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /data/slc/anaconda3/envs/tf1/lib/python3.7/site-packages/tensorflow/python/ops/losses/losses_impl.py:514: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
WARNING:tensorflow:From /data/slc/anaconda3/envs/tf1/lib/python3.7/site-packages/tensorflow/python/ops/metrics_impl.py:788: div (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Deprecated in favor of operator or tf.math.divide.
WARNING:tensorflow:From /data/slc/anaconda3/envs/tf1/lib/python3.7/site-packages/tensorflow/python/ops/math_ops.py:3066: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
INFO:tensorflow:Summary name h_lr_emb:0 is illegal; using h_lr_emb_0 instead.
INFO:tensorflow:Summary name h_lr_emb_deep:0 is illegal; using h_lr_emb_deep_0 instead.
INFO:tensorflow:Summary name fm_w:0 is illegal; using fm_w_0 instead.
INFO:tensorflow:Summary name Permutation-Layer/bn_log/beta:0 is illegal; using Permutation-Layer/bn_log/beta_0 instead.
INFO:tensorflow:Summary name Permutation-Layer/bn_log/gamma:0 is illegal; using Permutation-Layer/bn_log/gamma_0 instead.
INFO:tensorflow:Summary name Layer-1/h_lr_weights:0 is illegal; using Layer-1/h_lr_weights_0 instead.
INFO:tensorflow:Summary name Layer-1/biases:0 is illegal; using Layer-1/biases_0 instead.
INFO:tensorflow:Summary name Prediction/bn_inter/beta:0 is illegal; using Prediction/bn_inter/beta_0 instead.
INFO:tensorflow:Summary name Prediction/bn_inter/gamma:0 is illegal; using Prediction/bn_inter/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp0/weights:0 is illegal; using Prediction/Deep-part/mlp0/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp0/biases:0 is illegal; using Prediction/Deep-part/mlp0/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_0/beta:0 is illegal; using Prediction/Deep-part/bn_0/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_0/gamma:0 is illegal; using Prediction/Deep-part/bn_0/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp1/weights:0 is illegal; using Prediction/Deep-part/mlp1/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp1/biases:0 is illegal; using Prediction/Deep-part/mlp1/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_1/beta:0 is illegal; using Prediction/Deep-part/bn_1/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_1/gamma:0 is illegal; using Prediction/Deep-part/bn_1/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp2/weights:0 is illegal; using Prediction/Deep-part/mlp2/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp2/biases:0 is illegal; using Prediction/Deep-part/mlp2/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_2/beta:0 is illegal; using Prediction/Deep-part/bn_2/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_2/gamma:0 is illegal; using Prediction/Deep-part/bn_2/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/deep_out/weights:0 is illegal; using Prediction/Deep-part/deep_out/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/deep_out/biases:0 is illegal; using Prediction/Deep-part/deep_out/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp0/weights:0 is illegal; using Deep-part/mlp0/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp0/biases:0 is illegal; using Deep-part/mlp0/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_0/beta:0 is illegal; using Deep-part/bn_0/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_0/gamma:0 is illegal; using Deep-part/bn_0/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp1/weights:0 is illegal; using Deep-part/mlp1/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp1/biases:0 is illegal; using Deep-part/mlp1/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_1/beta:0 is illegal; using Deep-part/bn_1/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_1/gamma:0 is illegal; using Deep-part/bn_1/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp2/weights:0 is illegal; using Deep-part/mlp2/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp2/biases:0 is illegal; using Deep-part/mlp2/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_2/beta:0 is illegal; using Deep-part/bn_2/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_2/gamma:0 is illegal; using Deep-part/bn_2/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/deep_out/weights:0 is illegal; using Deep-part/deep_out/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/deep_out/biases:0 is illegal; using Deep-part/deep_out/biases_0 instead.
INFO:tensorflow:Summary name w1:0 is illegal; using w1_0 instead.
INFO:tensorflow:Summary name w2:0 is illegal; using w2_0 instead.
INFO:tensorflow:Summary name b_p:0 is illegal; using b_p_0 instead.
INFO:tensorflow:Done calling model_fn.
INFO:tensorflow:Create CheckpointSaverHook.
INFO:tensorflow:Graph was finalized.
2022-02-14 11:41:26.166106: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2022-02-14 11:41:26.192660: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400000000 Hz
2022-02-14 11:41:26.194363: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55555a1a7c70 executing computations on platform Host. Devices:
2022-02-14 11:41:26.194404: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): <undefined>, <undefined>
2022-02-14 11:41:26.300527: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1433] Found device 0 with properties: 
name: GeForce RTX 2080 Ti major: 7 minor: 5 memoryClockRate(GHz): 1.545
pciBusID: 0000:86:00.0
totalMemory: 10.76GiB freeMemory: 10.60GiB
2022-02-14 11:41:26.300585: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2022-02-14 11:41:26.301622: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-02-14 11:41:26.301634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2022-02-14 11:41:26.301640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2022-02-14 11:41:26.301722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10312 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5)
2022-02-14 11:41:26.304094: I tensorflow/compiler/xla/service/service.cc:150] XLA service 0x55555a7c98f0 executing computations on platform CUDA. Devices:
2022-02-14 11:41:26.304118: I tensorflow/compiler/xla/service/service.cc:158]   StreamExecutor device (0): GeForce RTX 2080 Ti, Compute Capability 7.5
INFO:tensorflow:Running local_init_op.
INFO:tensorflow:Done running local_init_op.
INFO:tensorflow:Saving checkpoints for 0 into ./checkpoint/movielens/20220213/model.ckpt.
2022-02-14 11:41:29.972505: I tensorflow/stream_executor/dso_loader.cc:152] successfully opened CUDA library libcublas.so.10.0 locally
2022-02-14 11:41:40.297611: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:101] Filling up shuffle buffer (this may take a while): 434220 of 500000
2022-02-14 11:41:41.757035: I tensorflow/core/kernels/data/shuffle_dataset_op.cc:140] Shuffle buffer filled.
INFO:tensorflow:loss = 2.590146, step = 0
INFO:tensorflow:global_step/sec: 12.4594
INFO:tensorflow:loss = 1.1115985, step = 100 (8.029 sec)
INFO:tensorflow:global_step/sec: 10.6828
INFO:tensorflow:loss = 0.9663845, step = 200 (9.359 sec)
INFO:tensorflow:global_step/sec: 10.6996
INFO:tensorflow:loss = 0.8815822, step = 300 (9.346 sec)
INFO:tensorflow:Saving checkpoints for 343 into ./checkpoint/movielens/20220213/model.ckpt.
Parsing ['../data/movielens/valid.libsvm']
INFO:tensorflow:Calling model_fn.
shape of embeddings: [None, 3, 10]
[None, 10, 800]
INFO:tensorflow:Summary name h_lr_emb:0 is illegal; using h_lr_emb_0 instead.
INFO:tensorflow:Summary name h_lr_emb_deep:0 is illegal; using h_lr_emb_deep_0 instead.
INFO:tensorflow:Summary name fm_w:0 is illegal; using fm_w_0 instead.
INFO:tensorflow:Summary name Permutation-Layer/bn_log/beta:0 is illegal; using Permutation-Layer/bn_log/beta_0 instead.
INFO:tensorflow:Summary name Permutation-Layer/bn_log/gamma:0 is illegal; using Permutation-Layer/bn_log/gamma_0 instead.
INFO:tensorflow:Summary name Layer-1/h_lr_weights:0 is illegal; using Layer-1/h_lr_weights_0 instead.
INFO:tensorflow:Summary name Layer-1/biases:0 is illegal; using Layer-1/biases_0 instead.
INFO:tensorflow:Summary name Prediction/bn_inter/beta:0 is illegal; using Prediction/bn_inter/beta_0 instead.
INFO:tensorflow:Summary name Prediction/bn_inter/gamma:0 is illegal; using Prediction/bn_inter/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp0/weights:0 is illegal; using Prediction/Deep-part/mlp0/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp0/biases:0 is illegal; using Prediction/Deep-part/mlp0/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_0/beta:0 is illegal; using Prediction/Deep-part/bn_0/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_0/gamma:0 is illegal; using Prediction/Deep-part/bn_0/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp1/weights:0 is illegal; using Prediction/Deep-part/mlp1/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp1/biases:0 is illegal; using Prediction/Deep-part/mlp1/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_1/beta:0 is illegal; using Prediction/Deep-part/bn_1/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_1/gamma:0 is illegal; using Prediction/Deep-part/bn_1/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp2/weights:0 is illegal; using Prediction/Deep-part/mlp2/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp2/biases:0 is illegal; using Prediction/Deep-part/mlp2/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_2/beta:0 is illegal; using Prediction/Deep-part/bn_2/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_2/gamma:0 is illegal; using Prediction/Deep-part/bn_2/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/deep_out/weights:0 is illegal; using Prediction/Deep-part/deep_out/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/deep_out/biases:0 is illegal; using Prediction/Deep-part/deep_out/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp0/weights:0 is illegal; using Deep-part/mlp0/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp0/biases:0 is illegal; using Deep-part/mlp0/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_0/beta:0 is illegal; using Deep-part/bn_0/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_0/gamma:0 is illegal; using Deep-part/bn_0/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp1/weights:0 is illegal; using Deep-part/mlp1/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp1/biases:0 is illegal; using Deep-part/mlp1/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_1/beta:0 is illegal; using Deep-part/bn_1/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_1/gamma:0 is illegal; using Deep-part/bn_1/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp2/weights:0 is illegal; using Deep-part/mlp2/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp2/biases:0 is illegal; using Deep-part/mlp2/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_2/beta:0 is illegal; using Deep-part/bn_2/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_2/gamma:0 is illegal; using Deep-part/bn_2/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/deep_out/weights:0 is illegal; using Deep-part/deep_out/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/deep_out/biases:0 is illegal; using Deep-part/deep_out/biases_0 instead.
INFO:tensorflow:Summary name w1:0 is illegal; using w1_0 instead.
INFO:tensorflow:Summary name w2:0 is illegal; using w2_0 instead.
INFO:tensorflow:Summary name b_p:0 is illegal; using b_p_0 instead.
INFO:tensorflow:Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2022-02-14T03:42:17Z
INFO:tensorflow:Graph was finalized.
2022-02-14 11:42:17.522644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2022-02-14 11:42:17.522730: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-02-14 11:42:17.522737: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2022-02-14 11:42:17.522743: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2022-02-14 11:42:17.522867: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10312 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5)
WARNING:tensorflow:From /data/slc/anaconda3/envs/tf1/lib/python3.7/site-packages/tensorflow/python/training/saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from ./checkpoint/movielens/20220213/model.ckpt-343
INFO:tensorflow:Running local_init_op.
INFO:tensorflow:Done running local_init_op.
INFO:tensorflow:Finished evaluation at 2022-02-14-03:42:28
INFO:tensorflow:Saving dict for global step 343: auc = 0.9335763, global_step = 343, logloss = 0.29085982, loss = 0.8944232, stop_criterion = 0.64271647
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 343: ./checkpoint/movielens/20220213/model.ckpt-343
WARNING:tensorflow:From /data/slc/anaconda3/envs/tf1/lib/python3.7/site-packages/tensorflow/python/summary/summary_iterator.py:68: tf_record_iterator (from tensorflow.python.lib.io.tf_record) is deprecated and will be removed in a future version.
Instructions for updating:
Use eager execution and: 
`tf.data.TFRecordDataset(path)`
INFO:tensorflow:global_step/sec: 4.52963
INFO:tensorflow:loss = 0.82153475, step = 400 (22.083 sec)
INFO:tensorflow:global_step/sec: 18.3535
INFO:tensorflow:loss = 0.82846725, step = 500 (5.448 sec)
INFO:tensorflow:global_step/sec: 14.4243
INFO:tensorflow:loss = 0.8808241, step = 600 (6.934 sec)
INFO:tensorflow:Saving checkpoints for 686 into ./checkpoint/movielens/20220213/model.ckpt.
Parsing ['../data/movielens/valid.libsvm']
INFO:tensorflow:Calling model_fn.
shape of embeddings: [None, 3, 10]
[None, 10, 800]
INFO:tensorflow:Summary name h_lr_emb:0 is illegal; using h_lr_emb_0 instead.
INFO:tensorflow:Summary name h_lr_emb_deep:0 is illegal; using h_lr_emb_deep_0 instead.
INFO:tensorflow:Summary name fm_w:0 is illegal; using fm_w_0 instead.
INFO:tensorflow:Summary name Permutation-Layer/bn_log/beta:0 is illegal; using Permutation-Layer/bn_log/beta_0 instead.
INFO:tensorflow:Summary name Permutation-Layer/bn_log/gamma:0 is illegal; using Permutation-Layer/bn_log/gamma_0 instead.
INFO:tensorflow:Summary name Layer-1/h_lr_weights:0 is illegal; using Layer-1/h_lr_weights_0 instead.
INFO:tensorflow:Summary name Layer-1/biases:0 is illegal; using Layer-1/biases_0 instead.
INFO:tensorflow:Summary name Prediction/bn_inter/beta:0 is illegal; using Prediction/bn_inter/beta_0 instead.
INFO:tensorflow:Summary name Prediction/bn_inter/gamma:0 is illegal; using Prediction/bn_inter/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp0/weights:0 is illegal; using Prediction/Deep-part/mlp0/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp0/biases:0 is illegal; using Prediction/Deep-part/mlp0/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_0/beta:0 is illegal; using Prediction/Deep-part/bn_0/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_0/gamma:0 is illegal; using Prediction/Deep-part/bn_0/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp1/weights:0 is illegal; using Prediction/Deep-part/mlp1/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp1/biases:0 is illegal; using Prediction/Deep-part/mlp1/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_1/beta:0 is illegal; using Prediction/Deep-part/bn_1/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_1/gamma:0 is illegal; using Prediction/Deep-part/bn_1/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp2/weights:0 is illegal; using Prediction/Deep-part/mlp2/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp2/biases:0 is illegal; using Prediction/Deep-part/mlp2/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_2/beta:0 is illegal; using Prediction/Deep-part/bn_2/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_2/gamma:0 is illegal; using Prediction/Deep-part/bn_2/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/deep_out/weights:0 is illegal; using Prediction/Deep-part/deep_out/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/deep_out/biases:0 is illegal; using Prediction/Deep-part/deep_out/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp0/weights:0 is illegal; using Deep-part/mlp0/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp0/biases:0 is illegal; using Deep-part/mlp0/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_0/beta:0 is illegal; using Deep-part/bn_0/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_0/gamma:0 is illegal; using Deep-part/bn_0/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp1/weights:0 is illegal; using Deep-part/mlp1/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp1/biases:0 is illegal; using Deep-part/mlp1/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_1/beta:0 is illegal; using Deep-part/bn_1/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_1/gamma:0 is illegal; using Deep-part/bn_1/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp2/weights:0 is illegal; using Deep-part/mlp2/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp2/biases:0 is illegal; using Deep-part/mlp2/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_2/beta:0 is illegal; using Deep-part/bn_2/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_2/gamma:0 is illegal; using Deep-part/bn_2/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/deep_out/weights:0 is illegal; using Deep-part/deep_out/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/deep_out/biases:0 is illegal; using Deep-part/deep_out/biases_0 instead.
INFO:tensorflow:Summary name w1:0 is illegal; using w1_0 instead.
INFO:tensorflow:Summary name w2:0 is illegal; using w2_0 instead.
INFO:tensorflow:Summary name b_p:0 is illegal; using b_p_0 instead.
INFO:tensorflow:Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2022-02-14T03:42:54Z
INFO:tensorflow:Graph was finalized.
2022-02-14 11:42:55.312666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2022-02-14 11:42:55.312729: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-02-14 11:42:55.312736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2022-02-14 11:42:55.312741: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2022-02-14 11:42:55.312850: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10312 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5)
INFO:tensorflow:Restoring parameters from ./checkpoint/movielens/20220213/model.ckpt-686
INFO:tensorflow:Running local_init_op.
INFO:tensorflow:Done running local_init_op.
INFO:tensorflow:Finished evaluation at 2022-02-14-03:43:05
INFO:tensorflow:Saving dict for global step 686: auc = 0.94233435, global_step = 686, logloss = 0.27284893, loss = 0.84093773, stop_criterion = 0.66948545
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 686: ./checkpoint/movielens/20220213/model.ckpt-686
INFO:tensorflow:global_step/sec: 4.5435
INFO:tensorflow:loss = 0.74992406, step = 700 (22.010 sec)
INFO:tensorflow:global_step/sec: 17.463
INFO:tensorflow:loss = 0.72789425, step = 800 (5.725 sec)
INFO:tensorflow:global_step/sec: 18.5977
INFO:tensorflow:loss = 0.7559412, step = 900 (5.377 sec)
INFO:tensorflow:global_step/sec: 14.0973
INFO:tensorflow:loss = 0.69737625, step = 1000 (7.095 sec)
INFO:tensorflow:Saving checkpoints for 1029 into ./checkpoint/movielens/20220213/model.ckpt.
Parsing ['../data/movielens/valid.libsvm']
INFO:tensorflow:Calling model_fn.
shape of embeddings: [None, 3, 10]
[None, 10, 800]
INFO:tensorflow:Summary name h_lr_emb:0 is illegal; using h_lr_emb_0 instead.
INFO:tensorflow:Summary name h_lr_emb_deep:0 is illegal; using h_lr_emb_deep_0 instead.
INFO:tensorflow:Summary name fm_w:0 is illegal; using fm_w_0 instead.
INFO:tensorflow:Summary name Permutation-Layer/bn_log/beta:0 is illegal; using Permutation-Layer/bn_log/beta_0 instead.
INFO:tensorflow:Summary name Permutation-Layer/bn_log/gamma:0 is illegal; using Permutation-Layer/bn_log/gamma_0 instead.
INFO:tensorflow:Summary name Layer-1/h_lr_weights:0 is illegal; using Layer-1/h_lr_weights_0 instead.
INFO:tensorflow:Summary name Layer-1/biases:0 is illegal; using Layer-1/biases_0 instead.
INFO:tensorflow:Summary name Prediction/bn_inter/beta:0 is illegal; using Prediction/bn_inter/beta_0 instead.
INFO:tensorflow:Summary name Prediction/bn_inter/gamma:0 is illegal; using Prediction/bn_inter/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp0/weights:0 is illegal; using Prediction/Deep-part/mlp0/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp0/biases:0 is illegal; using Prediction/Deep-part/mlp0/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_0/beta:0 is illegal; using Prediction/Deep-part/bn_0/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_0/gamma:0 is illegal; using Prediction/Deep-part/bn_0/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp1/weights:0 is illegal; using Prediction/Deep-part/mlp1/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp1/biases:0 is illegal; using Prediction/Deep-part/mlp1/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_1/beta:0 is illegal; using Prediction/Deep-part/bn_1/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_1/gamma:0 is illegal; using Prediction/Deep-part/bn_1/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp2/weights:0 is illegal; using Prediction/Deep-part/mlp2/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp2/biases:0 is illegal; using Prediction/Deep-part/mlp2/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_2/beta:0 is illegal; using Prediction/Deep-part/bn_2/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_2/gamma:0 is illegal; using Prediction/Deep-part/bn_2/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/deep_out/weights:0 is illegal; using Prediction/Deep-part/deep_out/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/deep_out/biases:0 is illegal; using Prediction/Deep-part/deep_out/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp0/weights:0 is illegal; using Deep-part/mlp0/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp0/biases:0 is illegal; using Deep-part/mlp0/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_0/beta:0 is illegal; using Deep-part/bn_0/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_0/gamma:0 is illegal; using Deep-part/bn_0/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp1/weights:0 is illegal; using Deep-part/mlp1/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp1/biases:0 is illegal; using Deep-part/mlp1/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_1/beta:0 is illegal; using Deep-part/bn_1/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_1/gamma:0 is illegal; using Deep-part/bn_1/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp2/weights:0 is illegal; using Deep-part/mlp2/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp2/biases:0 is illegal; using Deep-part/mlp2/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_2/beta:0 is illegal; using Deep-part/bn_2/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_2/gamma:0 is illegal; using Deep-part/bn_2/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/deep_out/weights:0 is illegal; using Deep-part/deep_out/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/deep_out/biases:0 is illegal; using Deep-part/deep_out/biases_0 instead.
INFO:tensorflow:Summary name w1:0 is illegal; using w1_0 instead.
INFO:tensorflow:Summary name w2:0 is illegal; using w2_0 instead.
INFO:tensorflow:Summary name b_p:0 is illegal; using b_p_0 instead.
INFO:tensorflow:Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2022-02-14T03:43:29Z
INFO:tensorflow:Graph was finalized.
2022-02-14 11:43:30.307727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2022-02-14 11:43:30.307793: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-02-14 11:43:30.307805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2022-02-14 11:43:30.307813: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2022-02-14 11:43:30.307915: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10312 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5)
INFO:tensorflow:Restoring parameters from ./checkpoint/movielens/20220213/model.ckpt-1029
INFO:tensorflow:Running local_init_op.
INFO:tensorflow:Done running local_init_op.
INFO:tensorflow:Finished evaluation at 2022-02-14-03:43:41
INFO:tensorflow:Saving dict for global step 1029: auc = 0.9464732, global_step = 1029, logloss = 0.26308122, loss = 0.8224931, stop_criterion = 0.6833919
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 1029: ./checkpoint/movielens/20220213/model.ckpt-1029
INFO:tensorflow:global_step/sec: 5.02433
INFO:tensorflow:loss = 0.5804389, step = 1100 (19.903 sec)
INFO:tensorflow:global_step/sec: 18.9936
INFO:tensorflow:loss = 0.61344314, step = 1200 (5.264 sec)
INFO:tensorflow:global_step/sec: 15.8742
INFO:tensorflow:loss = 0.64131486, step = 1300 (6.301 sec)
INFO:tensorflow:Saving checkpoints for 1372 into ./checkpoint/movielens/20220213/model.ckpt.
Parsing ['../data/movielens/valid.libsvm']
INFO:tensorflow:Calling model_fn.
shape of embeddings: [None, 3, 10]
[None, 10, 800]
INFO:tensorflow:Summary name h_lr_emb:0 is illegal; using h_lr_emb_0 instead.
INFO:tensorflow:Summary name h_lr_emb_deep:0 is illegal; using h_lr_emb_deep_0 instead.
INFO:tensorflow:Summary name fm_w:0 is illegal; using fm_w_0 instead.
INFO:tensorflow:Summary name Permutation-Layer/bn_log/beta:0 is illegal; using Permutation-Layer/bn_log/beta_0 instead.
INFO:tensorflow:Summary name Permutation-Layer/bn_log/gamma:0 is illegal; using Permutation-Layer/bn_log/gamma_0 instead.
INFO:tensorflow:Summary name Layer-1/h_lr_weights:0 is illegal; using Layer-1/h_lr_weights_0 instead.
INFO:tensorflow:Summary name Layer-1/biases:0 is illegal; using Layer-1/biases_0 instead.
INFO:tensorflow:Summary name Prediction/bn_inter/beta:0 is illegal; using Prediction/bn_inter/beta_0 instead.
INFO:tensorflow:Summary name Prediction/bn_inter/gamma:0 is illegal; using Prediction/bn_inter/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp0/weights:0 is illegal; using Prediction/Deep-part/mlp0/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp0/biases:0 is illegal; using Prediction/Deep-part/mlp0/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_0/beta:0 is illegal; using Prediction/Deep-part/bn_0/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_0/gamma:0 is illegal; using Prediction/Deep-part/bn_0/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp1/weights:0 is illegal; using Prediction/Deep-part/mlp1/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp1/biases:0 is illegal; using Prediction/Deep-part/mlp1/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_1/beta:0 is illegal; using Prediction/Deep-part/bn_1/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_1/gamma:0 is illegal; using Prediction/Deep-part/bn_1/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp2/weights:0 is illegal; using Prediction/Deep-part/mlp2/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp2/biases:0 is illegal; using Prediction/Deep-part/mlp2/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_2/beta:0 is illegal; using Prediction/Deep-part/bn_2/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_2/gamma:0 is illegal; using Prediction/Deep-part/bn_2/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/deep_out/weights:0 is illegal; using Prediction/Deep-part/deep_out/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/deep_out/biases:0 is illegal; using Prediction/Deep-part/deep_out/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp0/weights:0 is illegal; using Deep-part/mlp0/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp0/biases:0 is illegal; using Deep-part/mlp0/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_0/beta:0 is illegal; using Deep-part/bn_0/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_0/gamma:0 is illegal; using Deep-part/bn_0/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp1/weights:0 is illegal; using Deep-part/mlp1/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp1/biases:0 is illegal; using Deep-part/mlp1/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_1/beta:0 is illegal; using Deep-part/bn_1/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_1/gamma:0 is illegal; using Deep-part/bn_1/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp2/weights:0 is illegal; using Deep-part/mlp2/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp2/biases:0 is illegal; using Deep-part/mlp2/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_2/beta:0 is illegal; using Deep-part/bn_2/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_2/gamma:0 is illegal; using Deep-part/bn_2/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/deep_out/weights:0 is illegal; using Deep-part/deep_out/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/deep_out/biases:0 is illegal; using Deep-part/deep_out/biases_0 instead.
INFO:tensorflow:Summary name w1:0 is illegal; using w1_0 instead.
INFO:tensorflow:Summary name w2:0 is illegal; using w2_0 instead.
INFO:tensorflow:Summary name b_p:0 is illegal; using b_p_0 instead.
INFO:tensorflow:Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2022-02-14T03:44:04Z
INFO:tensorflow:Graph was finalized.
2022-02-14 11:44:04.743012: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2022-02-14 11:44:04.743079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-02-14 11:44:04.743096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2022-02-14 11:44:04.743102: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2022-02-14 11:44:04.743195: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10312 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5)
INFO:tensorflow:Restoring parameters from ./checkpoint/movielens/20220213/model.ckpt-1372
INFO:tensorflow:Running local_init_op.
INFO:tensorflow:Done running local_init_op.
INFO:tensorflow:Finished evaluation at 2022-02-14-03:44:15
INFO:tensorflow:Saving dict for global step 1372: auc = 0.949533, global_step = 1372, logloss = 0.26081014, loss = 0.826237, stop_criterion = 0.68872285
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 1372: ./checkpoint/movielens/20220213/model.ckpt-1372
INFO:tensorflow:global_step/sec: 4.87655
INFO:tensorflow:loss = 0.5043505, step = 1400 (20.506 sec)
INFO:tensorflow:global_step/sec: 18.5987
INFO:tensorflow:loss = 0.512659, step = 1500 (5.376 sec)
INFO:tensorflow:global_step/sec: 17.7698
INFO:tensorflow:loss = 0.5178553, step = 1600 (5.628 sec)
INFO:tensorflow:global_step/sec: 15.0718
INFO:tensorflow:loss = 0.56647867, step = 1700 (6.636 sec)
INFO:tensorflow:Saving checkpoints for 1715 into ./checkpoint/movielens/20220213/model.ckpt.
WARNING:tensorflow:From /data/slc/anaconda3/envs/tf1/lib/python3.7/site-packages/tensorflow/python/training/saver.py:966: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
Parsing ['../data/movielens/valid.libsvm']
INFO:tensorflow:Calling model_fn.
shape of embeddings: [None, 3, 10]
[None, 10, 800]
INFO:tensorflow:Summary name h_lr_emb:0 is illegal; using h_lr_emb_0 instead.
INFO:tensorflow:Summary name h_lr_emb_deep:0 is illegal; using h_lr_emb_deep_0 instead.
INFO:tensorflow:Summary name fm_w:0 is illegal; using fm_w_0 instead.
INFO:tensorflow:Summary name Permutation-Layer/bn_log/beta:0 is illegal; using Permutation-Layer/bn_log/beta_0 instead.
INFO:tensorflow:Summary name Permutation-Layer/bn_log/gamma:0 is illegal; using Permutation-Layer/bn_log/gamma_0 instead.
INFO:tensorflow:Summary name Layer-1/h_lr_weights:0 is illegal; using Layer-1/h_lr_weights_0 instead.
INFO:tensorflow:Summary name Layer-1/biases:0 is illegal; using Layer-1/biases_0 instead.
INFO:tensorflow:Summary name Prediction/bn_inter/beta:0 is illegal; using Prediction/bn_inter/beta_0 instead.
INFO:tensorflow:Summary name Prediction/bn_inter/gamma:0 is illegal; using Prediction/bn_inter/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp0/weights:0 is illegal; using Prediction/Deep-part/mlp0/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp0/biases:0 is illegal; using Prediction/Deep-part/mlp0/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_0/beta:0 is illegal; using Prediction/Deep-part/bn_0/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_0/gamma:0 is illegal; using Prediction/Deep-part/bn_0/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp1/weights:0 is illegal; using Prediction/Deep-part/mlp1/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp1/biases:0 is illegal; using Prediction/Deep-part/mlp1/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_1/beta:0 is illegal; using Prediction/Deep-part/bn_1/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_1/gamma:0 is illegal; using Prediction/Deep-part/bn_1/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp2/weights:0 is illegal; using Prediction/Deep-part/mlp2/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp2/biases:0 is illegal; using Prediction/Deep-part/mlp2/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_2/beta:0 is illegal; using Prediction/Deep-part/bn_2/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_2/gamma:0 is illegal; using Prediction/Deep-part/bn_2/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/deep_out/weights:0 is illegal; using Prediction/Deep-part/deep_out/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/deep_out/biases:0 is illegal; using Prediction/Deep-part/deep_out/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp0/weights:0 is illegal; using Deep-part/mlp0/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp0/biases:0 is illegal; using Deep-part/mlp0/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_0/beta:0 is illegal; using Deep-part/bn_0/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_0/gamma:0 is illegal; using Deep-part/bn_0/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp1/weights:0 is illegal; using Deep-part/mlp1/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp1/biases:0 is illegal; using Deep-part/mlp1/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_1/beta:0 is illegal; using Deep-part/bn_1/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_1/gamma:0 is illegal; using Deep-part/bn_1/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp2/weights:0 is illegal; using Deep-part/mlp2/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp2/biases:0 is illegal; using Deep-part/mlp2/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_2/beta:0 is illegal; using Deep-part/bn_2/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_2/gamma:0 is illegal; using Deep-part/bn_2/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/deep_out/weights:0 is illegal; using Deep-part/deep_out/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/deep_out/biases:0 is illegal; using Deep-part/deep_out/biases_0 instead.
INFO:tensorflow:Summary name w1:0 is illegal; using w1_0 instead.
INFO:tensorflow:Summary name w2:0 is illegal; using w2_0 instead.
INFO:tensorflow:Summary name b_p:0 is illegal; using b_p_0 instead.
INFO:tensorflow:Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2022-02-14T03:44:38Z
INFO:tensorflow:Graph was finalized.
2022-02-14 11:44:38.939913: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2022-02-14 11:44:38.939980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-02-14 11:44:38.939990: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2022-02-14 11:44:38.939998: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2022-02-14 11:44:38.940093: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10312 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5)
INFO:tensorflow:Restoring parameters from ./checkpoint/movielens/20220213/model.ckpt-1715
INFO:tensorflow:Running local_init_op.
INFO:tensorflow:Done running local_init_op.
INFO:tensorflow:Finished evaluation at 2022-02-14-03:44:49
INFO:tensorflow:Saving dict for global step 1715: auc = 0.94929606, global_step = 1715, logloss = 0.27304915, loss = 0.8670783, stop_criterion = 0.6762469
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 1715: ./checkpoint/movielens/20220213/model.ckpt-1715
INFO:tensorflow:No increase in metric "stop_criterion" for 343 steps, which is greater than or equal to max steps (342) configured for early stopping.
INFO:tensorflow:Requesting early stopping at global step 1720
INFO:tensorflow:Saving checkpoints for 1721 into ./checkpoint/movielens/20220213/model.ckpt.
Parsing ['../data/movielens/valid.libsvm']
INFO:tensorflow:Calling model_fn.
shape of embeddings: [None, 3, 10]
[None, 10, 800]
INFO:tensorflow:Summary name h_lr_emb:0 is illegal; using h_lr_emb_0 instead.
INFO:tensorflow:Summary name h_lr_emb_deep:0 is illegal; using h_lr_emb_deep_0 instead.
INFO:tensorflow:Summary name fm_w:0 is illegal; using fm_w_0 instead.
INFO:tensorflow:Summary name Permutation-Layer/bn_log/beta:0 is illegal; using Permutation-Layer/bn_log/beta_0 instead.
INFO:tensorflow:Summary name Permutation-Layer/bn_log/gamma:0 is illegal; using Permutation-Layer/bn_log/gamma_0 instead.
INFO:tensorflow:Summary name Layer-1/h_lr_weights:0 is illegal; using Layer-1/h_lr_weights_0 instead.
INFO:tensorflow:Summary name Layer-1/biases:0 is illegal; using Layer-1/biases_0 instead.
INFO:tensorflow:Summary name Prediction/bn_inter/beta:0 is illegal; using Prediction/bn_inter/beta_0 instead.
INFO:tensorflow:Summary name Prediction/bn_inter/gamma:0 is illegal; using Prediction/bn_inter/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp0/weights:0 is illegal; using Prediction/Deep-part/mlp0/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp0/biases:0 is illegal; using Prediction/Deep-part/mlp0/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_0/beta:0 is illegal; using Prediction/Deep-part/bn_0/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_0/gamma:0 is illegal; using Prediction/Deep-part/bn_0/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp1/weights:0 is illegal; using Prediction/Deep-part/mlp1/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp1/biases:0 is illegal; using Prediction/Deep-part/mlp1/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_1/beta:0 is illegal; using Prediction/Deep-part/bn_1/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_1/gamma:0 is illegal; using Prediction/Deep-part/bn_1/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp2/weights:0 is illegal; using Prediction/Deep-part/mlp2/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp2/biases:0 is illegal; using Prediction/Deep-part/mlp2/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_2/beta:0 is illegal; using Prediction/Deep-part/bn_2/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_2/gamma:0 is illegal; using Prediction/Deep-part/bn_2/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/deep_out/weights:0 is illegal; using Prediction/Deep-part/deep_out/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/deep_out/biases:0 is illegal; using Prediction/Deep-part/deep_out/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp0/weights:0 is illegal; using Deep-part/mlp0/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp0/biases:0 is illegal; using Deep-part/mlp0/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_0/beta:0 is illegal; using Deep-part/bn_0/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_0/gamma:0 is illegal; using Deep-part/bn_0/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp1/weights:0 is illegal; using Deep-part/mlp1/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp1/biases:0 is illegal; using Deep-part/mlp1/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_1/beta:0 is illegal; using Deep-part/bn_1/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_1/gamma:0 is illegal; using Deep-part/bn_1/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp2/weights:0 is illegal; using Deep-part/mlp2/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp2/biases:0 is illegal; using Deep-part/mlp2/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_2/beta:0 is illegal; using Deep-part/bn_2/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_2/gamma:0 is illegal; using Deep-part/bn_2/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/deep_out/weights:0 is illegal; using Deep-part/deep_out/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/deep_out/biases:0 is illegal; using Deep-part/deep_out/biases_0 instead.
INFO:tensorflow:Summary name w1:0 is illegal; using w1_0 instead.
INFO:tensorflow:Summary name w2:0 is illegal; using w2_0 instead.
INFO:tensorflow:Summary name b_p:0 is illegal; using b_p_0 instead.
INFO:tensorflow:Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2022-02-14T03:44:53Z
INFO:tensorflow:Graph was finalized.
2022-02-14 11:44:53.732618: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2022-02-14 11:44:53.732696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-02-14 11:44:53.732707: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2022-02-14 11:44:53.732714: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2022-02-14 11:44:53.732818: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10312 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5)
INFO:tensorflow:Restoring parameters from ./checkpoint/movielens/20220213/model.ckpt-1721
INFO:tensorflow:Running local_init_op.
INFO:tensorflow:Done running local_init_op.
INFO:tensorflow:Finished evaluation at 2022-02-14-03:45:01
INFO:tensorflow:Saving dict for global step 1721: auc = 0.94856524, global_step = 1721, logloss = 0.28094137, loss = 0.88942564, stop_criterion = 0.6676239
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 1721: ./checkpoint/movielens/20220213/model.ckpt-1721
INFO:tensorflow:Loss for final step: 0.3889225.
Early stopped, start evaluation...
Parsing ['../data/movielens/test.libsvm']
INFO:tensorflow:Calling model_fn.
shape of embeddings: [None, 3, 10]
[None, 10, 800]
INFO:tensorflow:Summary name h_lr_emb:0 is illegal; using h_lr_emb_0 instead.
INFO:tensorflow:Summary name h_lr_emb_deep:0 is illegal; using h_lr_emb_deep_0 instead.
INFO:tensorflow:Summary name fm_w:0 is illegal; using fm_w_0 instead.
INFO:tensorflow:Summary name Permutation-Layer/bn_log/beta:0 is illegal; using Permutation-Layer/bn_log/beta_0 instead.
INFO:tensorflow:Summary name Permutation-Layer/bn_log/gamma:0 is illegal; using Permutation-Layer/bn_log/gamma_0 instead.
INFO:tensorflow:Summary name Layer-1/h_lr_weights:0 is illegal; using Layer-1/h_lr_weights_0 instead.
INFO:tensorflow:Summary name Layer-1/biases:0 is illegal; using Layer-1/biases_0 instead.
INFO:tensorflow:Summary name Prediction/bn_inter/beta:0 is illegal; using Prediction/bn_inter/beta_0 instead.
INFO:tensorflow:Summary name Prediction/bn_inter/gamma:0 is illegal; using Prediction/bn_inter/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp0/weights:0 is illegal; using Prediction/Deep-part/mlp0/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp0/biases:0 is illegal; using Prediction/Deep-part/mlp0/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_0/beta:0 is illegal; using Prediction/Deep-part/bn_0/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_0/gamma:0 is illegal; using Prediction/Deep-part/bn_0/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp1/weights:0 is illegal; using Prediction/Deep-part/mlp1/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp1/biases:0 is illegal; using Prediction/Deep-part/mlp1/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_1/beta:0 is illegal; using Prediction/Deep-part/bn_1/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_1/gamma:0 is illegal; using Prediction/Deep-part/bn_1/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp2/weights:0 is illegal; using Prediction/Deep-part/mlp2/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/mlp2/biases:0 is illegal; using Prediction/Deep-part/mlp2/biases_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_2/beta:0 is illegal; using Prediction/Deep-part/bn_2/beta_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/bn_2/gamma:0 is illegal; using Prediction/Deep-part/bn_2/gamma_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/deep_out/weights:0 is illegal; using Prediction/Deep-part/deep_out/weights_0 instead.
INFO:tensorflow:Summary name Prediction/Deep-part/deep_out/biases:0 is illegal; using Prediction/Deep-part/deep_out/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp0/weights:0 is illegal; using Deep-part/mlp0/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp0/biases:0 is illegal; using Deep-part/mlp0/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_0/beta:0 is illegal; using Deep-part/bn_0/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_0/gamma:0 is illegal; using Deep-part/bn_0/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp1/weights:0 is illegal; using Deep-part/mlp1/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp1/biases:0 is illegal; using Deep-part/mlp1/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_1/beta:0 is illegal; using Deep-part/bn_1/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_1/gamma:0 is illegal; using Deep-part/bn_1/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp2/weights:0 is illegal; using Deep-part/mlp2/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/mlp2/biases:0 is illegal; using Deep-part/mlp2/biases_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_2/beta:0 is illegal; using Deep-part/bn_2/beta_0 instead.
INFO:tensorflow:Summary name Deep-part/bn_2/gamma:0 is illegal; using Deep-part/bn_2/gamma_0 instead.
INFO:tensorflow:Summary name Deep-part/deep_out/weights:0 is illegal; using Deep-part/deep_out/weights_0 instead.
INFO:tensorflow:Summary name Deep-part/deep_out/biases:0 is illegal; using Deep-part/deep_out/biases_0 instead.
INFO:tensorflow:Summary name w1:0 is illegal; using w1_0 instead.
INFO:tensorflow:Summary name w2:0 is illegal; using w2_0 instead.
INFO:tensorflow:Summary name b_p:0 is illegal; using b_p_0 instead.
INFO:tensorflow:Done calling model_fn.
INFO:tensorflow:Starting evaluation at 2022-02-14T03:45:05Z
INFO:tensorflow:Graph was finalized.
2022-02-14 11:45:05.824429: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1512] Adding visible gpu devices: 0
2022-02-14 11:45:05.824483: I tensorflow/core/common_runtime/gpu/gpu_device.cc:984] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-02-14 11:45:05.824490: I tensorflow/core/common_runtime/gpu/gpu_device.cc:990]      0 
2022-02-14 11:45:05.824495: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1003] 0:   N 
2022-02-14 11:45:05.824571: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1115] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10312 MB memory) -> physical GPU (device: 0, name: GeForce RTX 2080 Ti, pci bus id: 0000:86:00.0, compute capability: 7.5)
INFO:tensorflow:Restoring parameters from ./checkpoint/movielens/20220213/model.ckpt-1372
INFO:tensorflow:Running local_init_op.
INFO:tensorflow:Done running local_init_op.
INFO:tensorflow:Finished evaluation at 2022-02-14-03:45:10
INFO:tensorflow:Saving dict for global step 1372: auc = 0.9492631, global_step = 1372, logloss = 0.26148006, loss = 0.8275065, stop_criterion = 0.687783
INFO:tensorflow:Saving 'checkpoint_path' summary for global step 1372: ./checkpoint/movielens/20220213/model.ckpt-1372
